# Pentest checklist

## Obtaining shell

* [ ] FTP
  * [ ] login
    * [ ] anonymous - test@mail.com
    * [ ] admin - admin or something similar
    * [ ] bruteforce
  * [ ] directory listing
    * [ ] passive mode
  * [ ] writable folders
* [ ] SMB
  * [ ] login
    * [ ] anonymous access
    * [ ] admin - admin or username - username
  * [ ] readable files
  * [ ] writable folders
* [ ] NFS
  * [ ] list available folders: showmount -e \<IP>
    * [ ] mount -t nfs -o vers=2 \<ip>:\<folder> \<local folder>
      * [ ] if you get access denied, create a user with the same UID and GID as the owner of the remote folder, su as the new user and access the folder again
      * [ ] is the folder writable?
    * [ ] no\_root\_squash exploit
* [ ] SSH
  * [ ] login
    * [ ] try root - root, admin - admin or default credentials
    * [ ] if you know an username try it as both user and password
    * [ ] check for CVEs if the version is old
    * [ ] predictable RNG in old versions of Debian SSH (CVE-2008-0166)
  * [ ] do you own a private key?
    * [ ] ssh \<user>@\<ip> -i \<key>
    * [ ] scp -i \<key> \<source> \<user>@\<ip>:\<file> to write and edit files on target machine
  * [ ] is the shell restricted?
  * [ ] am I in a docker container?
* [ ] SMTP
  * [ ] EHLO test.com
    * [ ] banner grab and search for CVEs
    * [ ] VRFY username&#x20;
* [ ] IMAP
  * [ ] banner grab and CVEs
  * [ ] login: A1 LOGIN \<user> \<pass>
    * [ ] list mailboxes: A1 LIST INBOX \*
      * [ ] get messages: A1 FETCH \<folder>:\* (FLAGS)
        * [ ] read mail: A1 FETCH \<folder>:\<message> body\[text]
* [ ] POP3
  * [ ] banner grab and CVEs
  * [ ] login: USER \<user> PASS \<pass>
    * [ ] CAPA
    * [ ] LIST
      * [ ] RETR \<message number>
* [ ] VNC/RDP
  * [ ] banner grab and search for CVEs
  * [ ] connect to remote host, identify OS type  and version from login page
* [ ] Finger
  * [ ] list all users: finger @\<host>&#x20;
  * [ ] get user info: finger \<username>@\<host>
* [ ] Ident
  * [ ] nc -nv \<ip> 113
    * [ ] &#x20;to get the user associated with a service, i.e. samba running on port 445 and you're connected to it using port 1234, type 445,1234
* [ ] SNMP
  * [ ] snmpwalk -v 2 -c public \<ip>
  * [ ] snmpwalk -v 2 -c private \<ip>
* [ ] Databases
  * [ ] is my ip filtered?
  * [ ] login
    * [ ] default credentials
    * [ ] try dumb: admin - admin, mysql - mysql, username as both user and password etc...
  * [ ] can I run commands?
    * [ ] are my commands executed as privileged user?
    * [ ] search for external modules\plugins\conf files that allow to run commands
  * [ ] can I read/write files?
    * [ ] can I access system files?
  * [ ] search for credentials and try to reuse them in other services
* [ ] HTTP/HTTPS page
  * [ ] webpage
    * [ ] Is the hosted site's source code on Github/Gitlab?
    * [ ] BURP scan
      * [ ] check for additional requests on page load
      * [ ] check loaded page for comments,hardcoded fields, passwords, hashes in source code
    * [ ] inspect page for information about webapp and server version (usually in the footer or trigger a 404 message)
      * [ ] search for CVEs
    * [ ] inspect website for About Us pages that can disclose usernames
    * [ ] test input fields for SQLi
      * [ ] SQLi to write webshell in site home folder
    * [ ] test URLs arguments for RFI or directory traversal
    * [ ] test upload forms for LFI
      * [ ] try spoofing file extension
      * [ ] try to edit the content-type header
      * [ ] try adding magic bytes + modified content-type header
    * [ ] wordpress webapp?
      * [ ] scan for plugins and styles
      * [ ] check every plugin for CVEs
      * [ ] check every style for CVEs
    * [ ] indexed folder
      * [ ] search for files that allow to identify server/webapp type and version
      * [ ] search for plaintext credentials or hashes
      * [ ] is .git repo?
        * [ ] dump repository
        * [ ] search for keys
    * [ ] login form
      * [ ] check form code
        * [ ] identify webapp name/version from POST fields
          * [ ] CVEs
        * [ ] are there commented fields in the form? Try uncommenting and setting values
        * [ ] are there any session tokens or failed attempts counters?
          * [ ] if not, bruteforce with hydra + http-post module
      * [ ] login bypass CVEs
      * [ ] can register a new user?
      * [ ] existing users are disclosed by a different error message i.e. "invalid user" instead of "login failed"
      * [ ] SQLi login bypass
      * [ ] admin - admin, admin - sitename, root - root, default credentials
    * [ ] admin control panel
      * [ ] find version of server, database, additional tools
      * [ ] is there a way to upload files?
      * [ ] is there a way to execute code?
      * [ ] authenticated CVEs
    * [ ] gobuster/dirb scan
      * [ ] 2XX/3XX: found/redirect
        * [ ] repeat process for all discovered pages
      * [ ] 401: unauthorized
        * [ ] admin - admin, admin with empty password
        * [ ] bruteforce
      * [ ] 404: not found
        * [ ] server version disclosure
        * [ ] use WFUZZ if the server does not return 404 on a not existing page (custom error messages)
    * [ ] nikto scan
      * [ ] try CVEs
      * [ ] access indexed folders

## Privilege escalation

* [ ] Am I in a restricted shell?
* [ ] Am I in a docker container?
  * [ ] try to escape docker container
  * [ ] try mounting /dev/sda1 to gain access to actual host partition
  * [ ] try to obtain a new shell by ssh-ing to the local host
* [ ] Is the shell fully interactive?
* [ ] Obtain user information
  * [ ] username, privileges, groups
    * [ ] group/privileges exploits (i.e. JuicyPotato, docker/lxc/lcd group privesc)
  * [ ] increased permissions (i.e. can edit system files/folders, sudo without password)
  * [ ] check path and environment variables
  * [ ] search for useful files (scripts, ssh keys, logs, history files, plaintext creds) in home folder or webapp root folder if the shell is obtained via RCE/RFI
  * [ ] search for custom binaries in home folder/webapp root folder
  * [ ] search for files or folders globally readable/writable
  * [ ] list other users and groups
  * [ ] list other open terminal/remote desktop sessions
  * [ ] try logging in as another user
    * [ ] try dumb: username - username, username and empty password
    * [ ] try reusing credentials
    * [ ] ssh \<new user>@127.0.0.1
* [ ] Obtain machine info
  * [ ] hostname
  * [ ] OS type, version, patches applied
    * [ ] check for kernel exploits and common CVEs
    * [ ] check CVEs released after last applied Windows hotfix
    * [ ] are there any compilers installed? (makes executing kernel exploits way easier)
  * [ ] network information
  * [ ] look for additional partitions
* [ ] Running processes
  * [ ] running as current user
  * [ ] running as root / SYSTEM
    * [ ] check for CVEs
  * [ ] startup tasks
  * [ ] scheduled tasks
    * [ ] misconfigurations (writable folders/scripts, tasks can be edited to execute arbitrary files, wildcards in path)
  * [ ] services running as localhost
    * [ ] databases
      * [ ] login
        * [ ] default credentials
        * [ ] admin - admin mysql - mysql, etc...
        * [ ] search in web application folders for config files with hashes/cleartext credentials for db
      * [ ] can execute code as privileged user?
      * [ ] CVEs for privesc (focus on this especially if the db is running as privileged user)
      * [ ] search for user credentials, try to reuse the passwords to login as another user
    * [ ] webapps
      * [ ] search web folder for server type and version
        * [ ] check for local CVEs
      * [ ] search web folder for credentials/hashes
    * [ ] &#x20;other service
      * [ ] expose to remote connections via ssh reverse port forward (requires authentication)
* [ ] List installed programs
  * [ ] check for misconfigurations (unquoted paths, writable install folders, run with SUID)
  * [ ] search for local CVEs
  * [ ] are there any credentials stored? (files, logs, registry keys)
  * [ ] can I use anything to dump memory?
  * [ ] are there any programming languages installed?

## Password testing

* [ ] known usernames as user/password
  * [ ] bruteforce password
* [ ] username with empty password / anonymous login
* [ ] service default credentials
  * [ ] first login credentials still in use
* [ ] service name as user/password
  * [ ] cewl + john for fuzzying
* [ ] hostname / page title as user/password
* [ ] dumb user/password, try with empty password field too if accepted&#x20;

```
qwerty
qwerty123
Qwerty123!
admin
admin123
adminadmin
sysadmin
password
root
toor
123456
secret
s3cret
login
letmein
letmeinplease
manager
m4n4n3r
guest
user
superuser
info
test
```
